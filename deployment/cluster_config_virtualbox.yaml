# PowerFlex Cluster Configuration - VirtualBox Deployment
# For local VM testing with VirtualBox/Hyper-V

cluster:
  name: "powerflex-demo-local"
  # Generate with: python -c "import secrets; print(secrets.token_hex(32))"
  cluster_secret: "CHANGE_ME_GENERATE_NEW_SECRET"
  python_path: "/usr/bin/python3"
  project_root: "/opt/powerflex"

# VirtualBox Host-Only Network: 192.168.56.0/24
# Gateway: 192.168.56.1 (your host machine)

mdm:
  hostname: "powerflex-mdm"
  ip: "192.168.56.10"
  port: 8001
  ssh_user: "ubuntu"
  ssh_port: 22

sds_nodes:
  - name: "sds1"
    hostname: "powerflex-sds1"
    ip: "192.168.56.11"
    ssh_user: "ubuntu"
    ssh_port: 22
    sds_id: 1
    data_port: 9700
    control_port: 9100
    mgmt_port: 9200
    storage_root: "/var/powerflex/sds1"
    capacity_gb: 100
    devices: "blk0,blk1,blk2"
    
  - name: "sds2"
    hostname: "powerflex-sds2"
    ip: "192.168.56.12"
    ssh_user: "ubuntu"
    ssh_port: 22
    sds_id: 2
    data_port: 9700
    control_port: 9100
    mgmt_port: 9200
    storage_root: "/var/powerflex/sds2"
    capacity_gb: 100
    devices: "blk0,blk1,blk2"

sdc_nodes:
  - name: "sdc1"
    hostname: "powerflex-sdc1"
    ip: "192.168.56.13"
    ssh_user: "ubuntu"
    ssh_port: 22
    sdc_id: 1
    nbd_port: 8005
    control_port: 8003
    mgmt_port: 8004

mgmt:
  hostname: "powerflex-mdm"
  ip: "192.168.56.10"  # Co-located with MDM
  port: 5000
  ssh_user: "ubuntu"
  ssh_port: 22

network:
  subnet: "192.168.56.0/24"
  gateway: "192.168.56.1"
  mdm_ports: [8001]
  sds_ports: [9100, 9200, 9700]
  sdc_ports: [8003, 8004, 8005]
  mgmt_ports: [5000]
  max_rtt_ms: 50  # Local network should be <50ms
  heartbeat_interval: 10

deployment:
  install_deps: true
  python_packages:
    - fastapi==0.128.5
    - uvicorn==0.40.0
    - flask==3.1.2
    - sqlalchemy==2.0.46
    - pydantic==2.12.5
    - requests==2.32.5
    - bcrypt==4.2.1
  system_packages:
    - python3-pip
    - python3-venv
    - git
    - sqlite3
  create_systemd: true
  enable_on_boot: true
  log_dir: "/var/log/powerflex"
  backup_dir: "/var/backups/powerflex"

tests:
  smoke_test: true
  integration_test: true
  failure_test: false
